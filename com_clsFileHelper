'=====================================
' Class Module: com_clsFileHelper
'=====================================
Option Explicit

Public Function FileExists(path As String) As Boolean
    FileExists = (Dir(path) <> "")
End Function

Public Function GetFileName(path As String) As String
    GetFileName = Mid(path, InStrRev(path, "\") + 1)
End Function

Public Function GetFolder(path As String) As String
    GetFolder = Left(path, InStrRev(path, "\") - 1)
End Function

Public Function ReadTextFile(path As String) As String
    Dim txt As String, f As Integer
    If Not FileExists(path) Then Err.Raise vbObjectError + 200, , "ファイルがありません"
    f = FreeFile: Open path For Input As #f
    txt = Input$(LOF(f), f): Close #f
    ReadTextFile = txt
End Function

Public Sub WriteTextFile(path As String, content As String)
    Dim f As Integer
    f = FreeFile: Open path For Output As #f
    Print #f, content: Close #f
End Sub
